1 REM *************************
2 REM **                     **
3 REM **  BANCO  DE  DADOS   **
4 REM **                     **
5 REM **  LUIZ C. DUFFLES    **
6 REM **                     **
7 REM **      M S X          **
8 REM **                     **
9 REM **   AGOSTO DE 1985    **
10 REM**                     **
11 REM*************************
12 REM EDIT Less memory available on disk systems - Menos memoria disponivel em sistemas com disco
20 CLEAR15000
25 DIM ND$(150) : DIM NE$(150) : DIM NF$(150) : DIM NG$(150) : DIM NH$(150) : DIM NB$(150) : DIM NC$ (150)
27 LD$="ARQ"
30 CLS : LOCATE 0,10:PRINT"SE JA' HOUVER UM ARQUIVO PRESSIONE     <ENTER>, CASO CONTRARIO DIGITE         'PRIMEIRA' E PRESSIONE <ENTER>" : GOSUB 500 : IF R$ <> "PRIMEIRA" THEN GOSUB 8000
50 GOTO 1000
500 R$="" : INPUT R$ : RETURN
1000 CLS:LOCATE 12,0:PRINT"BANCO DE DADOS" :PRINT: PRINT" OPCOES" :PRINT : PRINT" 1- INICIALIZAR BANCO DE DADOS" : PRINT" 2- INCLUSAO" : PRINT" 3- BUSCA, CANCELAMENTO E ALTERACAO" : PRINT " 4- ORDENACAO DO ARQUIVO"
1002 PRINT " 5- LISTAGEM DO ARQUIV0" : PRINT" 6- GRAVACAO DO ARQUIVO EM FITA" : PRINT
1005 GOSUB 500
1010 ON VAL (R$) GOSUB 2000,3000,4000,5000,7000,9000
1050 GOTO 1000
2000 REM INICIALIZACAO
2005 CLS : PRINT "CONFIRMA INICIALIZACAO (S/N)?": GOSUB 500 : IF R$ ="N" THEN RETURN
2011 CLS :LOCATE 10,8: PRINT 'INICIALIZANDO O ARQUIVO"
2013 FOR K = 1 TO 150 : ND$(K) = "" : NE$(K) = "" : NF$(k) = "" : NB$(K) = "": NH$(K) = "" : NEXT K : I=0
2015 CP$(1) = "NOME"
2020 CP$(2) ="ENDERECO"
2030 CP$(3) ="BAIRRO"
2040 CP$(4) = "CIDADE"
2045 CP$(5) = "ESTADO"
2046 CP$(6) = "CEP"
2047 CP$(7) = "TELEFONE"
2050 RETURN
3000 CLS : PRINT"CONFIRMA INCLUSAO?" : GOSUB 500 : IF R$ <> "S" THENRETURN
3010 IF I < 150 THEN I=I+1
3015 K=I
3020 GOSUB 3090 : GOSUB 3700 : GOSUB 3800 : GOSUB 3900 : GOSUB 3950 :GOSUB 3100 : GOSUB 3200
3025 CLS : PRINT "DESEJA DUTRA ENTRADA (S/N)?" : GOSUB 500 : IF R$="S" THEN 3010
3030 GOSUB 3500
3035 RETURN
3090 CLS : PRINT"QUAL O "; CP$(1) :GOSUB 500 : ND$(K) = R$
3092 R$ = "" :RETURN
3100 CLS : PRINT " QUAL O ";CP$(6) :GOSUB 500 : NB$(K) = R$
3110 R$ = "" : RETURN
3200 CLS : PRINT "QUAL O ";CP$(7) :GOSUB 500 : NC$(K) = R$
3210 R$ = "" : RETURN
3500 CLS:LOCATE 15,O:PRINT"FICHA :";K:PRINT: PRINT CP$(1), ND$(K)
3510 PRINT : PRINT CP$(2), NE$(K)
3520 PRINT : PRINT CP$(3), NF$(K)
3530 PRINT : PRINT CP$(4), NG$(K)
3535 PRINT : PRINT CP$(5), NH$(K)
3536 PRINT : PRINT CP$(6), NB$(K)
3538 PRINT : PRINT CP$(7), NC$(K)
3540 PRINT : PRINT: PRINT "(1-7) ALTERACAO - C/CANCELAR - F/FIM - A/AVANCAR - V/VOLTAR"
3550 GOSUB 500
3560 IF R$ = "F" THEN RETURN
3570 IF R$ = "C" THEN GOSUB 11000
3580 IF R$ = "1" THEN GOSUB 3090
3590 IF R$ = "2" THEN GOSUB 3700
3600 IF R$ = "3" THEN GOSUB 3800
3610 IF R$ = "4" THEN GOSUB 3900
3615 IF R$ = "5" THEN GOSUB 3950
3616 IF R$ = "6" THEN GOSUB 3100
3618 IF R$ = "7" THEN GOSUB 3200
3620 IF R$ = "A" THEN GOSUB 10500
3623 IF R$ = "V" THEN GOSUB 10600
3625 GOTO 3500
3700 CLS : PRINT "QUAL O "; CP$(2): GOSUB 500 : NE$(K)=R$
3705 R$ = "": RETURN
3800 CLS : PRINT " QUAL O "; CP$(3): GOSUB 500 : NF$(K)=R$
3805 R$ = "" : RETURN
3900 CLS : PRINT "QUAL O "; CP$(4): GOSUB 500 : NG$(K)=R$
3905 R$ = "" : RETURN
3950 CLS : PRINT "QUAL O "; CP$(5): GOSUB 500 : NH$(K)=R$
3960 R$ = "" : RETURN
4000 REM BUSCA
4010 CLS : PRINT "DESEJA FAZER BUSCA POR QUE CAMPO ?" : GOSUB 500 : FOR K = 1 TO 7 : IF R$ = CP$(K)THEN 4015 ELSE NEXT K
4012 CLS:PRINT"CAMPO NAO DEFINIDO. PRESS. <ENTER>      P/ CONTINUAR":GOSUB500: RETURN
4015 CLS : PRINT "QUAL O ITEM PROCURADO ?" : GOSUB 500
4020 IF K=1 THEN 4100
4022 IF K=2 THEN 4200
4024 IF K=3 THEN 4300
4030 IF K=4 THEN 4400
4032 IF K=5 THEN 4500
4040 IF K=6 THEN 4600
4050 IF K=7 THEN 4700
4100 FOR K=1 TO I : IF R$=ND$(K) THEN GOSUB 3500
4120 NEXT K : RETURN
4200 FOR K=1 TO I : IF R$=NE$(K) THEN GOSUB 3500
4220 NEXT K : RETURN
4300 FOR K=1 TO I :  IF R$=NF$(K) THEN GOSUB 3500
4320 NEXT K : RETURN
4400 FOR K=1 TO I :  IF R$=NG$(K) THEN GOSUB 3500
4420 NEXT K : RETURN
4500 FOR K=1 TO I :  IF R$=NH$(K) THEN GOSUB 3500
4510 NEXT K : RETURN
4600 FOR K=1 TO I :  IF R$=NB$(K) THEN GOSUB 3500
4610 NEXT K : RETURN
4700 FOR K=1 TO I :  IF R$=NC$(K) THEN GOSUB 3500
4710 NEXT K: RETURN
5000 REM ORDENACAO
5010 CLS : PRINT "DESEJA ORDENACAO POR QUE CAMPO ?" : GOSUB 500
5015 FOR K = 1 TO 7 : IF R$ = CP$(K) THEN 5100 ELSE NEXT K
5020 PRINT "ESTE CAMPO NAO ESTA DEFINIDO" : FOR R = 1 TO 500 : NEXT R: GOTO 5010
5100 CLS : PRINT "ORDENACAO POR "CP$(K)
5200 FOR J=1 TO I - 1
5210 FOR R=J+1 TO I
5220 GOSUB 10000
5230 NEXT R
5240 NEXT J
5250 RETURN
5500 REM TROCA GERAL
5510 T$=ND$(R) : ND$(R)=ND$(J) : ND$(J)=T$
5520 T$=NE$(R) : NE$(R)=NE$(J) : NE$(J)=T$
5530 T$=NF$(R) : NF$(R)=ND$(J) : NF$(J)=T$
5540 T$=NG$(R) : NG$(R)=NG$(J) : NG$(J)=T$
5545 T$=NH$(R) : NH$(R)=NH$(J) : NH$(J)=T$
5547 T$=NB$(R) : NB$(R)=NB$(J) : NB$(J)=T$
5548 T$=NC$(R) : NC$(R)=NC$(J) : NC$(J)=T$
5550 RETURN
7000 REM LISTAGEM
7010 K = 1 : GOSUB 3500
7050 RETURN
8000 REM LEITURA
8010 CLS : PRINT"PREPARE O DISCO E PRESS. <ENTER>" : PRINT "OU PRESS. <C> E <ENTER> P/ DESISTIR": GOSUB 500 : IF R$ <>"" THEN RETURN
8015 OPEN "LD$" FOR INPUT AS1
8030 INPUT #1,I
8031 FOR R=1 TO 7
8032 INPUT #1,CP$(R)
8037 NEXTR
8040 FOR R = 1 TO I
8051 INPUT #1 ,ND$(R)
8052 INPUT #1 ,NE$(R)
8053 INPUT #1 ,NF$(R)
8054 INPUT #1 ,NG$(R)
8055 INPUT #1 ,NH$(R)
8056 INPUT #1 ,NB$(R)
8057 INPUT #1 ,NC$(R)
8060 NEXT R
8061 CLOSE #1
8070 RETURN
9000 REM GRAVACAO
9010 CLS : PRINT"PREPARE O DISCO E PRESS. <ENTER>" : PRINT "OU PRESS. <C> E <ENTER> P/ DESISTIR": GOSUB 500 : IF R$ <>"" THEN RETURN
9015 OPEN "LD$" FOR OUTPUT AS1
9030 PRINT #1,I
9031 FOR R=1 TO 7
9032 PRINT #1,CP$(R)
9037 NEXTR
9040 FOR R = 1 TO I
9051 PRINT #1 ,ND$(R)
9052 PRINT #1 ,NE$(R)
9053 PRINT #1 ,NF$(R)
9054 PRINT #1 ,NG$(R)
9055 PRINT #1 ,NH$(R)
9056 PRINT #1 ,NB$(R)
9057 PRINT #1 ,NC$(R)
9060 NEXT R
9061 CLOSE #1
9070 RETURN
10000 IF K=1 AND ND$(J) > ND$(R) THEN GOSUB 5500
10010 IF K=2 AND NE$(J) > NE$(R) THEN GOSUB 5500
10020 IF K=3 AND NF$(J) > NF$(R) THEN GOSUB 5500
10030 IF K=4 AND NG$(J) > NG$(R) THEN GOSUB 5500
10040 IF K=5 AND NH$(J) > NH$(R) THEN GOSUB 5500
10042 IF K=6 AND NB$(J) > NB$(R) THEN GOSUB 5500
10044 IF K=7 AND NC$(J) > NC$(R) THEN GOSUB 5500
10050 RETURN
10500 IF K >= I THEN RETURN
10510 K = K + 1
10520 RETURN
10600 IF K = 1 THEN RETURN
10610 K = K - 1
10620 RETURN
11000 REM CANCELAHENTO
11005 IF I = 0 THEN RETURN
11010 FOR B = K + 1 TO I
11020 ND$(B-1) = ND$(B) : NE$(B-1) = NE$(B) : NF$(B-1) = NF$(B) : NG$(B-1) = NG$(B) : NH$(B-1) = NH$(B) : NB$(B-1) = NB$(B) : NC$(B-1) = NC$(B)
11030 NEXT B
11035 ND$(I) = "" : NE$(I) = "" : NF$(I) = "" : NG$(I) = "" : NH$(I) = "" : NB$(I) = "" : NC$(I) = ""
11037 I = I - 1
11040 RETURN